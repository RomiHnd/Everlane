(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2229],{3406:function(e,t,n){"use strict";n.d(t,{Z:function(){return z}});var o=n(59499),r=n(67294),i=n(93967),c=n.n(i),a=n(81938),s=n(49111),l=n(11163),u=n(57646),d=n(61245),p=function(e){var t=e.onCompleted,n=e.onError;return(0,d.Z)("/auth/facebook/callback","/api/v2/session",{keysToRevalidate:["/api/v2/geolocation","/api/v2/braintree_token"],extractData:function(e){return e.session},onCompleted:t,onError:n})},f=n(10069),g=n(30318),m=n(45672),v=n(56689),_=n(50029),h=n(64687),y=n.n(h);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var w="An error occured. Please try again.",j={hasGrantedPermissions:function(){return new Promise(function(e,t){FB.api("/me/permissions",function(n){n.error?t():e("declined"!==n.data.find(function(e){return"email"===e.permission}).status)})})},login:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.siteLocation,o=void 0===n?"generic facebook":n,r=t.extraAuthParams,i=void 0===r?{}:r,c=t.signIn,a=t.setIsLoading;return new Promise(function(t,n){"undefined"==typeof FB&&n(Error(w));var r,s=O(O({scope:"email,public_profile,user_birthday,user_location",auth_type:"rerequest"},i),{},{site_location:o});FB.login((r=(0,_.Z)(y().mark(function o(r){var i;return y().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!r.authResponse){o.next=12;break}return o.next=3,e.hasGrantedPermissions();case 3:if(!(o.sent&&"connected"===r.status)){o.next=11;break}return o.next=7,c(s);case 7:(i=o.sent)?t(i.session):n(Error(w)),o.next=12;break;case 11:n(Error("\nYou did not grant permission to use your\nemail address. Please grant permission by\nconnecting with Facebook again.\n"));case 12:a(!1),n(Error("The Facebook login window was closed. Please try again."));case 14:case"end":return o.stop()}},o)})),function(e){return r.apply(this,arguments)}),s)})}},P=n(21434),E=n.n(P),k=n(85893),x=function(e){var t=e.className,n=e.siteLocation,i=e.iconOnly,a=e.onSuccess,s=e.onError,d=(0,l.useRouter)().asPath,_=(0,r.useState)(!1),h=_[0],y=_[1],b=(0,f.ZP)({assistantId:(0,f.wA)(d),chatIcon:!1,chatWindow:!1}).handleStartKustomer,O=p({onCompleted:function(e){var t=e.session,o=Math.trunc(Date.now()/1e3).toString();y(!1),(0,g.s0)(v.ZP.User.SIGN_IN,{site_location:n,user:null==t?void 0:t.user,visitor:null==t?void 0:t.visitor,timestamp:o}),null!=t&&t.user&&b({chatIcon:!1,chatWindow:(0,f.ve)(),user:null==t?void 0:t.user}),a()},onError:function(e){y(!1),s(e)}}).mutate;return(0,k.jsx)(u.Z,{type:"button",variant:i?"secondary":"secondary-icon",icon:!0,className:c()(t,E()["facebook-connect__button"]),onClick:function(){y(!0),(0,g.s0)(v.ZP.Login.FACEBOOK_BUTTON),j.login({siteLocation:n,signIn:O,setIsLoading:y})},disabled:h,children:(0,k.jsxs)("div",{className:E()["facebook-connect__cta"],children:[!h&&(0,k.jsx)(m.Z,{src:"https://media.everlane.com/image/upload/v1698955728/Facebook_Logo.svg",alt:"Log in with Facebook",containerClassName:c()(E()["facebook-connect__cta-image"],(0,o.Z)({},E()["facebook-connect__cta-image--icon-only"],i)),aspectRatio:{width:1,height:1},width:18,height:18,sizes:"18px"}),!i&&(0,k.jsx)("span",{className:E()["facebook-connect__cta-text"],children:h?"Connecting":"Facebook"})]})})},N=n(9008),S=n.n(N),Z=function(e){var t=e.onCompleted,n=e.onError;return(0,d.Z)("/auth/google_gis/callback","/api/v2/session",{keysToRevalidate:["/api/v2/geolocation","/api/v2/braintree_token"],extractData:function(e){return e.session},onCompleted:t,onError:n})},D=n(36808),L=n.n(D),C=n(15649);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var T="Google authentication failed. Please try again.",A=n(3672),B=n.n(A),G=function(e){var t=e.apiKey,i=e.token,a=e.className,s=e.siteLocation,d=e.iconOnly,p=e.onSuccess,h=e.onError,b=(0,l.useRouter)().asPath,O=(0,r.useState)(!1),w=O[0],j=O[1],P=(0,f.ZP)({assistantId:(0,f.wA)(b),chatIcon:!1,chatWindow:!1}).handleStartKustomer,E=function(e){j(!1),h(e)},x=function(e){var t=e.session,n=Math.trunc(Date.now()/1e3).toString();j(!1),(0,g.s0)(v.ZP.User.SIGN_IN,{site_location:s,user:null==t?void 0:t.user,visitor:null==t?void 0:t.visitor,timestamp:n}),null!=t&&t.user&&P({chatIcon:!1,chatWindow:(0,f.ve)(),user:null==t?void 0:t.user}),p()},N=Z({onCompleted:x,onError:E}).mutate;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(S(),{children:(0,k.jsx)("meta",{name:"referrer",content:"strict-origin-when-cross-origin"})}),(0,k.jsx)(u.Z,{type:"button",variant:d?"secondary":"secondary-icon",icon:!0,className:c()(a,B()["google-connect__button"]),onClick:function(){var e,o,r,c,a,l;return j(!0),(0,g.s0)(v.ZP.Login.GOOGLE_BUTTON),(r=void 0===(o=(e={siteLocation:s,apiKey:t,token:i,signIn:N}).siteLocation)?"generic google":o,c=e.apiKey,a=e.token,l=e.signIn,L().remove("g_state"),new Promise(function(e,t){if(n.g.window.navigator.userAgent.includes("FBAN/FBIOS")||n.g.window.navigator.userAgent.includes("Instagram")){var o,i={redirect_uri:"".concat(window.location.origin,"/auth/google_oauth2/callback"),response_type:"code",scope:"email profile",client_id:c,fetch_basic_profile:!0,state:a},s=new URLSearchParams("");Object.keys(i).forEach(function(e){return s.append(e,i[e])}),L().set(C.Z.OAUTH_REDIRECT_PREVIOUS_PATH,window.location.pathname),window.location="https://accounts.google.com/o/oauth2/v2/auth?".concat(s.toString()),t(Error("Talking with Googleâ€¦"));return}google.accounts.id.initialize({client_id:c,scope:"email profile",ux_mode:"popup",auto_select:!0,cancel_on_tap_outside:!1,use_fedcm_for_prompt:!0,callback:(o=(0,_.Z)(y().mark(function n(o){var i;return y().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(o&&o.credential)){n.next=7;break}return n.next=3,l(R(R({},o),{},{siteLocation:r}));case 3:(i=n.sent)?e(i.session):t(Error(T)),n.next=8;break;case 7:t(Error(T));case 8:case"end":return n.stop()}},n)})),function(e){return o.apply(this,arguments)})}),google.accounts.id.prompt()})).then(x).catch(E)},disabled:w,children:(0,k.jsxs)("div",{className:B()["google-connect__cta"],children:[!w&&(0,k.jsx)(m.Z,{src:"https://media.everlane.com/image/upload/v1644614726/i/icons8-google.svg",alt:"Log in with Google",containerClassName:c()(B()["google-connect__cta-image"],(0,o.Z)({},B()["google-connect__cta-image--icon-only"],d)),aspectRatio:{width:1,height:1},width:18,height:18,sizes:"18px"}),!d&&(0,k.jsx)("span",{className:B()["google-connect__cta-text"],children:w?"Connecting":"Google"})]})})]})},M=function(e){var t,n,o,r,i;window.fbAsyncInit=function(){FB.init({appId:e,channelUrl:"//".concat(window.location.host,"/channel.html"),status:!0,cookie:!0,oauth:!0,xfbml:!0,version:"v21.0"})},n="script",o="facebook-jssdk",i=(t=document).getElementsByTagName(n)[0],t.getElementById(o)||((r=t.createElement(n)).id=o,r.src="https://connect.facebook.net/en_US/sdk.js",i.parentNode.insertBefore(r,i))},U=n(85425),F=n(99221),K=n.n(F),z=function(e){var t=e.handleError,n=void 0===t?null:t,i=e.handleSuccess,l=void 0===i?null:i,u=e.siteLocation,d=e.wrapperClassName,p=e.buttonClassName,f=void 0===p?null:p,g=e.iconOnly,m=void 0!==g&&g,v=(0,a.Z)().data,_=null!=v?v:{},h=_.googleAuthApiKey,y=_.facebookApiKey,b=(0,s.Z)().data,O=null==b?void 0:b.omniauthToken;return((0,r.useEffect)(function(){(0,U.Z)("https://accounts.google.com/gsi/client?onload=initClient"),y&&M(y)},[y]),O)?(0,k.jsxs)("div",{className:c()(K()["social-connect"],void 0===d?null:d),children:[(0,k.jsx)(G,{className:c()(K()["social-connect__button"],f,(0,o.Z)({},K()["social-connect__button--icon-only"],m)),siteLocation:u,onSuccess:l,onError:n,apiKey:h,token:O,iconOnly:m}),(0,k.jsx)(x,{className:c()(K()["social-connect__button"],f,(0,o.Z)({},K()["social-connect__button--icon-only"],m)),siteLocation:u,onSuccess:l,onError:n,iconOnly:m})]}):null}},45672:function(e,t,n){"use strict";n.d(t,{Z:function(){return P}});var o,r=n(59499),i=n(4730),c=n(93967),a=n.n(c),s=n(25675),l=n.n(s),u=n(67294),d=n(31397),p=n(55844),f=["urlSuffix","src"];function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}(0,d.v6)({cloudName:"everlane",secure:!0,secureDistribution:"media.everlane.com",privateCdn:!0});var v={fetchFormat:"auto",dpr:"2.0",quality:"auto:best:sensitive"},_=(o=function(e){var t=e.aspectRatio,n=e.width,o=e.isZoomed,r=e.quality;return m({crop:"fill",aspectRatio:"".concat(t.width,":").concat(t.height),width:o?2*n:n},r&&{quality:r})},function(e){var t=e.urlSuffix,n=e.src,r=(0,i.Z)(e,f);return(0,d.Q2)((0,p.Z)(n),{cloud:{urlSuffix:t},transformations:m(m({},v),o(r))})}),h=n(75066),y=n.n(h),b=n(85893),O=["priority","className","containerClassName","alt","style","src","suffix","width","height","sizes","aspectRatio","loader","unoptimized","isZoomed"];function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var P=function(e){var t=e.priority,n=e.className,o=e.containerClassName,r=e.alt,c=e.style,s=e.src,d=e.suffix,p=e.width,f=e.height,g=e.sizes,m=e.aspectRatio,v=void 0===m?{width:p,height:f}:m,h=e.loader,w=void 0===h?_:h,P=e.unoptimized,E=e.isZoomed,k=void 0!==E&&E,x=(0,i.Z)(e,O),N=(0,u.useState)(null),S=N[0],Z=N[1],D=(0,u.useState)(!1),L=D[0],C=D[1],I=p>150;return((0,u.useEffect)(function(){I&&Z(w({src:s,aspectRatio:v,isZoomed:!1,urlSuffix:d,quality:"10",sizes:"5vw",width:p>1600||k?"100":"30"}))},[s,I]),s)?(0,b.jsx)("div",{style:c,className:void 0===o?"":o,children:(0,b.jsx)(l(),j({className:a()(y()["responsive-image"],n),loader:function(e){return w(j(j({},e),{},{aspectRatio:v,isZoomed:k,urlSuffix:d}))},alt:r,src:s,width:p,height:f,sizes:void 0===g?"(max-width: 480px) 62vw, (min-width: 1000px) 25vw":g,priority:void 0!==t&&t,unoptimized:void 0!==P&&P,blurDataURL:I&&S?S:void 0,placeholder:I&&S?"blur":"empty",onLoad:function(){return C(!0)},style:{filter:L?"blur(0px)":"blur(20px)",transition:"filter 0.5s linear"}},x))}):null}},55844:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o=n(91896);function r(e){try{return new URL(e,"https://media.everlane.com").pathname.split("/").slice(-2).join("/").split(".")[0]}catch(t){return(0,o.Z)(Error("Cannot extract Cloudinary filename from ".concat(e)),{originalError:t}),""}}},90290:function(e,t,n){"use strict";function o(e){var t;return e&&(e.message||(null===(t=e.responseJSON)||void 0===t?void 0:t.message))||"Something went wrong. Please try again."}n.d(t,{e:function(){return o}})},24677:function(e,t,n){"use strict";n.d(t,{_:function(){return r}});var o=n(67294),r=function(){var e,t,o,r;return"ontouchstart"in(null===(e=n.g)||void 0===e?void 0:e.document.documentElement)||(null===(t=n.g)||void 0===t?void 0:t.navigator.maxTouchPoints)>0||(null===(o=n.g)||void 0===o?void 0:null===(r=o.navigator)||void 0===r?void 0:r.msMaxTouchPoints)>0};t.Z=function(){var e,t=null===(e=n.g.window)||void 0===e?void 0:e.matchMedia("(max-width: 768px)"),r=(0,o.useState)((null==t?void 0:t.matches)||!1),i=r[0],c=r[1],a=function(e){c((null==e?void 0:e.matches)||!1)};return(0,o.useEffect)(function(){return null!=t&&t.addEventListener&&t.addEventListener("change",a),function(){null!=t&&t.removeEventListener&&t.removeEventListener("change",a)}},[]),i}},36123:function(e,t,n){"use strict";var o=n(59499),r=n(50029),i=n(4730),c=n(64687),a=n.n(c),s=n(67294),l=n(54760),u=n(96639),d=n(61245),p=["mutate"];function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}t.Z=function(e){var t,n=e.onCompleted,o=e.onError,c=(0,l.Z)({keysToRevalidate:["/api/v2/session","/api/v2/orders/preview"]}).mutate,f=(0,d.Z)("/api/v2/users/availability",null,{fetcher:u.U2,keysToRevalidate:["/api/v2/session"],onCompleted:n,onError:o}),m=f.mutate,v=(0,i.Z)(f,p),_=(0,s.useCallback)((t=(0,r.Z)(a().mark(function e(t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(g({emailOptin:t.emailOptin},t));case 2:return n=e.sent,e.next=5,c({visitor:{email:t.email}});case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),[m,c]);return g(g({},v),{},{mutate:_})}},54760:function(e,t,n){"use strict";var o=n(59499),r=n(96639),i=n(61245),c=n(49111);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}t.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,c.Z)().data,n=null==t?void 0:t.visitor.sessionId;return(0,i.Z)(n?"/api/v2/visitors/".concat(n):null,null,s(s({},e),{},{keysToRevalidate:e.keysToRevalidate||["/api/v2/session"],fetcher:r.r$}))}},57013:function(e,t,n){"use strict";n.d(t,{E:function(){return o},v:function(){return r}});var o={GENERIC:"generic",MOBILE_HOMEPAGE_MODAL:"mobile homepage modal",COLLECTIONS_MODAL:"collections modal",PRODUCTS_MODAL:"products modal",WUNDERKIND_MODAL:"wunderkind signup modal",PASSWORD_RESET:"password reset",CHECKOUT:"checkout",INTERNATIONAL_LANDING_PAGE:"international landing page",FOOTER_EMAIL_FORM:"footer email form"},r=function(e){return e?"/"===e?o.MOBILE_HOMEPAGE_MODAL:e.includes("checkout")?o.CHECKOUT:e.includes("collections")?o.COLLECTIONS_MODAL:e.includes("products")?o.PRODUCTS_MODAL:o.GENERIC:null}},85425:function(e,t){"use strict";t.Z=function(e,t){var n=document.createElement("script"),o=document.getElementsByTagName("script")[0];n.defer=1,n.onload=n.onreadystatechange=function(e,o){(o||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n=void 0,!o&&t&&setTimeout(t,0))},n.src=e,o.parentNode.insertBefore(n,o)}},99221:function(e){e.exports={"social-connect":"styles_social-connect__NFwGv","social-connect__button":"styles_social-connect__button__xoNwB","social-connect__button--icon-only":"styles_social-connect__button--icon-only__MT_yy"}},21434:function(e){e.exports={"facebook-connect__cta":"styles_facebook-connect__cta__R46Xo","facebook-connect__cta-image":"styles_facebook-connect__cta-image__kX4o7","facebook-connect__cta-image--icon-only":"styles_facebook-connect__cta-image--icon-only__NfXyN","facebook-connect__cta-text":"styles_facebook-connect__cta-text__xkdQS"}},3672:function(e){e.exports={"google-connect__cta":"styles_google-connect__cta__ivNNW","google-connect__cta-image":"styles_google-connect__cta-image__6lIuQ","google-connect__cta-image--icon-only":"styles_google-connect__cta-image--icon-only__gWN8i","google-connect__cta-text":"styles_google-connect__cta-text__7VQBC"}},75066:function(e){e.exports={"image-hover":"styles_image-hover__e5Ktk","image-hover__container":"styles_image-hover__container__G2A2h","image-hover__inner-container":"styles_image-hover__inner-container__U0DX8","responsive-image":"styles_responsive-image__5f_zr"}}}]);
//# sourceMappingURL=2229-cfc22f405a163d9f.js.map